{% extends "home.html" %}
{% block title %}{{ post.post_title }}{% endblock %}

{% block content %}
<main class="min-vh-100" style="background: linear-gradient(135deg, hsla(239, 84%, 67%, 1.00) 0%, rgba(139, 92, 246, 1) 50%, rgba(168, 85, 247, 1) 100%);">
    <div class="container py-1">
        <div class="row justify-content-center"> 
            <div class="col-lg-10">         
                <article class="bg-white rounded-4 shadow-lg px-2 py-3 px-md-5 mb-4">
                    <header class="mb-4">
                        <h1 class="display-5 fs-2 fw-bold text-dark mb-2">{{ post.post_title }}</h1>
                        <div class="d-flex align-items-center text-muted">
                            <span class="me-3">Posted by <strong class="text-dark">{{ post.user }}</strong></span>
                            <span>{{ post.posted_on }}</span>
                        </div>
                    </header>
                
                    <section class="mb-3">
                        <div class="post-content fs-6 lh-lg text-dark">
                            {{ post.post_content|linebreaks }}
                        </div>
                    </section>

                    <div class="d-flex justify-content-end gap-2">
                        {% if request.user.username == post.user %}
                            <a href="{% url 'edit_post' post.slug %}" class="btn btn-warning">
                                <i class="fas fa-edit me-1"></i>
                                Edit Post
                            </a>
                            <form method="POST" action="{% url 'delete_post' post.slug %}">
                                {% csrf_token %}
                                <button class="btn btn-danger">
                                    <i class="fas fa-trash-alt me-1"></i>
                                    Delete Post
                                </button>
                            </form>
                        {% endif %}
                    </div>

                </article>

                <div class="mb-3">
                    <h5 class="ps-2 ps-md-3 fs-5 text-white fw-bold">Leave a Comment</h5>
                    <form method="post">
                        {% csrf_token %}
                        {{ form.your_comment }}
                        <div class="d-flex justify-content-end mt-1">
                            <button type="submit" class="btn btn-primary">Post Comment</button>
                        </div>
                    </form>
                </div>

                <!-- Comments Section -->
                <section class="bg-white rounded-4 shadow-lg p-2 p-md-5">
                    {% if post.comments %}
                        <header class="mb-4">
                            <h3 class="h4 fw-bold text-dark mb-0">Comments ({{ post.comments|length }})</h3>
                        </header>
                        
                        <div class="comments-list">
                            {% for comment in post.comments %}
                                <div class="comment-item p-2 mb-2 rounded-3" style="background-color: rgba(248, 250, 252, 1); border-left: 4px solid #6366f1;">
                                    <div class="comment-content mb-2">
                                        <p class="mb-0 text-dark fs-6">{{ comment.your_comment }}</p>
                                    </div>
                                    <div class="comment-meta d-flex align-items-center text-muted small">
                                        <span class="me-3">by <strong class="text-dark">{{ comment.user }}</strong></span>
                                        <span>{{ comment.commented_on }}</span>
                                    </div>
                                </div>
                            {% endfor %}
                        </div>
                    {% else %}
                        <div class="text-center py-5">
                            <div class="mb-3">
                                <div class="d-inline-flex align-items-center justify-content-center rounded-circle" 
                                     style="width: 80px; height: 80px; background-color: rgba(248, 250, 252, 1);">
                                    <span class="fs-1">ðŸ’¬</span>
                                </div>
                            </div>
                            <h4 class="text-muted mb-2">No Comments Yet</h4>
                            <p class="text-muted mb-0">Be the first to share your thoughts on this post!</p>
                        </div>
                    {% endif %}
                </section> 
            </div>
        </div>
    </div>
</main>
{% endblock content %}